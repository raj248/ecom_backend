import{y as $,u as z,r as l,S as G,x as J}from"./index-lrQuldHs.js";import{u as K}from"./index.esm-BUE4Z1sU.js";import{A as f}from"./ProductServices-DkrntO0G.js";import{n as g,b as S}from"./button-rh3FTULs.js";import{u as N}from"./DrawerButton-CHM5Wu-i.js";import{u as W}from"./useTranslationValue-2zmYr2dJ.js";const st=n=>{const b=$(),c=z(),{setIsUpdate:d,lang:T}=l.useContext(G),{openDrawer:L,closeDrawer:p}=J(),[m,h]=l.useState([]),[s,x]=l.useState("en"),[r,E]=l.useState({}),[v,I]=l.useState(!1),[O,u]=l.useState(!1),{setServiceId:j}=N(),{handlerTextTranslateHandler:w}=W();let A=[];(async()=>{for(let t=0;t<m.length;t++){const a=await w(m[t],s);A=[...A,{name:{[s]:m[t],...a}}]}})();const{control:q,handleSubmit:B,register:k,setValue:i,clearErrors:y,formState:{errors:F}}=K(),H=async({title:t,name:a,option:e})=>{var Q,V;try{if(!n&&m.length===0){g("Minimum one value is required for add attribute!");return}u(!0);const o=await w(t,s,r==null?void 0:r.title),_=await w(a,s,r==null?void 0:r.name),D={title:{...o,[s]:t},name:{..._,[s]:a},variants:A,option:e,type:"attribute",lang:s};if(n){const C=await f.updateAttributes(n,D);d(!0),u(!1),S(C.message),p(),b.invalidateQueries(["attributes"])}else{const C=await f.addAttribute(D);d(!0),u(!1),S(C.message),p(),b.invalidateQueries(["attributes"])}}catch(o){u(!1),g(o?(V=(Q=o==null?void 0:o.response)==null?void 0:Q.data)==null?void 0:V.message:o==null?void 0:o.message)}},M=async({name:t})=>{try{if(u(!0),n){const a=await f.updateChildAttributes({ids:c.pathname.split("/")[2],id:n},{name:{[s]:t},status:v?"show":"hide"});d(!0),u(!1),S(a.message),b.invalidateQueries(["attribute"]),p()}else{const a=await f.addChildAttribute(c.pathname.split("/")[2],{name:{[s]:t},status:v?"show":"hide"});d(!0),u(!1),S(a.message),b.invalidateQueries(["attribute"]),p()}}catch(a){g(a?a.response.data.message:a.message),p(),u(!1),j()}},P=t=>{x(t),Object.keys(r).length>0&&(i("title",r.title[t||"en"]),i("name",r.name[t||"en"]))},R=t=>{h([...m.filter((a,e)=>e!==t)])},U=t=>{t.preventDefault(),t.target.value!==""&&(h([...m,t.target.value]),t.target.value="")};return l.useEffect(()=>{if(!n){E({}),i("title"),i("name"),i("option"),y("title"),y("name"),y("option"),h([]),x(T),i("language",s);return}},[y,n,L,i,c,T]),l.useEffect(()=>{c.pathname==="/attributes"&&n?(async()=>{var t,a;try{const e=await f.getAttributeById(n);e&&(E(e),i("title",e.title[s||"en"]),i("name",e.name[s||"en"]),i("option",e.option))}catch(e){g(((a=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:a.message)||(e==null?void 0:e.message))}})():c.pathname===`/attributes/${c.pathname.split("/")[2]}`&&(async()=>{var t,a;try{const e=await f.getChildAttributeById({id:c.pathname.split("/")[2],ids:n});e&&(i("name",e.name[s||"en"]),I(e.status==="show"))}catch(e){g(((a=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:a.message)||(e==null?void 0:e.message))}})()},[n]),{control:q,language:s,handleSubmit:B,onSubmits:M,onSubmit:H,register:k,errors:F,variants:m,setVariants:h,addVariant:U,removeVariant:R,published:v,setPublished:I,isSubmitting:O,handleSelectLanguage:P}};export{st as u};
