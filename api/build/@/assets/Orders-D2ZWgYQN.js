import{r as H,S as ae,l as te,e as re,j as e,w as le}from"./index-lrQuldHs.js";import{B as c,n as ie}from"./button-rh3FTULs.js";import{C as J,a as K}from"./card-w6jK4kZ9.js";import{I as y}from"./input-DxgA4gbo.js";import{C as ne}from"./ProductServices-DkrntO0G.js";import{S as C,a as T,b as w,c as O,d as l}from"./select-7doUwPnS.js";import{T as de,a as oe,b as ce,c as me,d as n}from"./table-pH1NcXB9.js";import{L as m}from"./label-D0mdihLM.js";import{u as he,q as xe}from"./Layout-zjBccTHe.js";import{e as Q}from"./exportFromJSON-BvevaQwb.js";import{u as ge}from"./useFilter-CTY6t_y8.js";import{O as U}from"./OrderServices-BKD454yT.js";import{N as pe}from"./NotFound-DffgNZ-O.js";import{P as je}from"./PageTitle-DEDGWyYG.js";import{O as ue}from"./OrderTable-llrnU06R.js";import{T as fe}from"./TableLoading-BpKh234J.js";import{s as be}from"./spinner-CkndCogW.js";import{A as ve}from"./AnimatedContent-DSnt0TWS.js";import"./index-C148XJoK.js";import"./Combination-DMBpnunk.js";import"./index-BOuINoA5.js";import"./tslib.es6-BGws65QO.js";import"./floating-ui.dom-BM6icrOT.js";import"./useDisableForDemo-dHOka9Cq.js";import"./CouponServices-DZWPN_Z6.js";import"./CurrencyServices-BtWGRbQW.js";import"./Status-bPmvzZ27.js";import"./Tooltip-D68gOM7t.js";import"./index-BtKdcUoa.js";import"./SelectStatus-CZ5F_A-M.js";const Xe=()=>{var R,M,V,_;const{time:h,setTime:S,status:x,endDate:g,setStatus:D,setEndDate:P,startDate:p,currentPage:A,searchText:j,searchRef:F,method:u,setMethod:k,setStartDate:E,setSearchText:$,handleChangePage:z,handleSubmitForAll:I,resultsPerPage:f}=H.useContext(ae),{t:s}=te(),[b,v]=H.useState(!1),{data:a,isLoading:G,error:L}=re({queryKey:["allOrders",h,u,x,A,g,p,f,j],queryFn:()=>U.getAllOrders({day:h,method:u,status:x,page:A,endDate:g,startDate:p,limit:f,customerName:j}),staleTime:600*1e3,gcTime:900*1e3,placeholderData:le}),{currency:W,getNumber:X,getNumberTwo:d}=he(),{dataTable:Y,serviceData:N}=ge(a==null?void 0:a.orders),Z=async()=>{var r,o,q;try{v(!0);const i=await U.getAllOrders({page:1,day:h,method:u,status:x,endDate:g,download:!0,startDate:p,limit:a==null?void 0:a.totalDoc,customerName:j}),se=(r=i==null?void 0:i.orders)==null?void 0:r.map(t=>{var B;return{_id:t._id,invoice:t.invoice,subTotal:d(t.subTotal),shippingCost:d(t.shippingCost),discount:d(t==null?void 0:t.discount),total:d(t.total),paymentMethod:t.paymentMethod,status:t.status,user_info:(B=t==null?void 0:t.user_info)==null?void 0:B.name,createdAt:t.createdAt,updatedAt:t.updatedAt}});Q({data:se,fileName:"orders",exportType:Q.types.csv}),v(!1)}catch(i){v(!1),ie(((q=(o=i==null?void 0:i.response)==null?void 0:o.data)==null?void 0:q.message)||(i==null?void 0:i.message))}},ee=()=>{S(""),k(""),D(""),P(""),E(""),$(""),F.current.value=""};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"lg:flex lg:items-center lg:justify-between py-8 gap-2",children:[e.jsx("div",{className:"min-w-0 flex-1",children:e.jsx(je,{children:s("Orders")})}),e.jsxs("form",{onSubmit:I,className:"mt-3 md:flex lg:mt-0 lg:ml-4 gap-2",children:[e.jsx("div",{className:"mt-2 md:mt-0"}),e.jsx("div",{className:"mt-2 md:mt-0"}),e.jsx("div",{className:"mt-2 md:mt-0"})]})]}),e.jsx(ve,{children:e.jsx(J,{className:"min-w-0 shadow-sm overflow-hidden bg-white dark:bg-gray-800 rounded-t-lg rounded-0 mb-4",children:e.jsxs(K,{children:[e.jsxs("form",{onSubmit:I,children:[e.jsxs("div",{className:"grid gap-4 lg:gap-4 xl:gap-6 md:gap-2 md:grid-cols-5 pt-5 pb-3",children:[e.jsx("div",{children:e.jsx(y,{ref:F,type:"search",name:"search",placeholder:"Search by Customer Name"})}),e.jsx("div",{children:e.jsxs(C,{onValueChange:D,children:[e.jsx(T,{children:e.jsx(w,{placeholder:s("Status")})}),e.jsxs(O,{children:[e.jsx(l,{value:"Delivered",children:s("PageOrderDelivered")}),e.jsx(l,{value:"Pending",children:s("PageOrderPending")}),e.jsx(l,{value:"Processing",children:s("PageOrderProcessing")}),e.jsx(l,{value:"Cancel",children:s("OrderCancel")})]})]})}),e.jsx("div",{children:e.jsxs(C,{onValueChange:S,children:[e.jsx(T,{children:e.jsx(w,{placeholder:s("Orderlimits")})}),e.jsxs(O,{children:[e.jsx(l,{value:"5",children:s("DaysOrders5")}),e.jsx(l,{value:"7",children:s("DaysOrders7")}),e.jsx(l,{value:"15",children:s("DaysOrders15")}),e.jsx(l,{value:"30",children:s("DaysOrders30")})]})]})}),e.jsx("div",{children:e.jsxs(C,{onValueChange:k,children:[e.jsx(T,{children:e.jsx(w,{placeholder:s("Method")})}),e.jsxs(O,{children:[e.jsx(l,{value:"Cash",children:s("Cash")}),e.jsx(l,{value:"Card",children:s("Card")}),e.jsx(l,{value:"Credit",children:s("Credit")})]})]})}),e.jsx("div",{children:b?e.jsxs(c,{disabled:!0,type:"button",className:"h-12 w-full",children:[e.jsx("img",{src:be,alt:"Loading",width:20,height:10})," ",e.jsx("span",{className:"font-serif ml-2 font-light",children:"Processing"})]}):e.jsxs(c,{onClick:Z,disabled:((R=a==null?void 0:a.orders)==null?void 0:R.length)<=0||b,type:"button",className:`${(((M=a==null?void 0:a.orders)==null?void 0:M.length)<=0||b)&&"opacity-50 cursor-not-allowed bg-emerald-600"}  `,children:["Download All Orders",e.jsx("span",{className:"ml-2 text-base",children:e.jsx(xe,{})})]})})]}),e.jsxs("div",{className:"pb-8 grid gap-4 lg:gap-6 xl:gap-6 lg:grid-cols-3 xl:grid-cols-3 md:grid-cols-3 sm:grid-cols-1 py-2",children:[e.jsxs("div",{children:[e.jsx(m,{children:"Start Date"}),e.jsx(y,{type:"date",name:"startDate",onChange:r=>E(r.target.value)})]}),e.jsxs("div",{children:[e.jsx(m,{children:"End Date"}),e.jsx(y,{type:"date",name:"startDate",onChange:r=>P(r.target.value)})]}),e.jsxs("div",{className:"flex items-center xl:gap-x-4 gap-x-1 flex-grow-0 md:flex-grow lg:flex-grow xl:flex-grow",children:[e.jsxs("div",{className:"w-full inline-grid mx-1 mt-2",children:[e.jsx(m,{className:"invisible",children:"Filter"}),e.jsx(c,{type:"submit",className:"h-10",children:"Filter"})]}),e.jsxs("div",{className:"w-full inline-grid mt-2",children:[e.jsx(m,{className:"invisible",children:"Reset"}),e.jsx(c,{className:"h-10",variant:"outline",onClick:ee,type:"reset",children:e.jsx("span",{className:"text-black dark:text-gray-200",children:"Reset"})})]})]})]})]}),G?e.jsx(fe,{row:12,col:7,width:160,height:20}):L?e.jsx("span",{className:"text-center mx-auto text-red-500",children:L}):(N==null?void 0:N.length)!==0?e.jsxs("div",{children:[e.jsx(de,{className:"mb-8 dark:bg-gray-900",children:e.jsxs(oe,{children:[e.jsx(ce,{children:e.jsxs(me,{children:[e.jsx(n,{children:s("InvoiceNo")}),e.jsx(n,{children:s("TimeTbl")}),e.jsx(n,{children:s("CustomerName")}),e.jsx(n,{children:s("MethodTbl")}),e.jsx(n,{children:s("AmountTbl")}),e.jsx(n,{children:s("OderStatusTbl")}),e.jsx(n,{children:s("ActionTbl")}),e.jsx(n,{className:"text-right",children:s("InvoiceTbl")})]})}),e.jsx(ue,{orders:Y})]})}),e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx(ne,{resultsperpage:f,totalresults:a==null?void 0:a.totalDoc,onChange:z})})]}):e.jsx(pe,{title:"Sorry, There are no orders right now."})]})})}),((V=a==null?void 0:a.methodTotals)==null?void 0:V.length)>0&&e.jsx(J,{className:"min-w-0 shadow-sm overflow-hidden bg-white dark:bg-gray-800 rounded-t-lg rounded-0 mb-4",children:e.jsx(K,{className:"p-6",children:e.jsx("div",{className:"flex gap-1",children:(_=a==null?void 0:a.methodTotals)==null?void 0:_.map((r,o)=>e.jsx("div",{className:"dark:text-gray-300",children:(r==null?void 0:r.method)&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"font-medium",children:[" ",r.method]})," :"," ",e.jsxs("span",{className:"font-semibold mr-2",children:[W,X(r.total)]})]})},o+1))})})})]})};export{Xe as default};
