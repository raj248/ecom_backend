import{a as ze,b as Ze,e as He,A as Xe,P as ke,c as Ge}from"./ProductServices-afE79VKB.js";import{d as J,u as Ke}from"./Layout-B1bU_74f.js";import{g as ge,r as n,u as Qe,S as We,L as et}from"./index-BmZ_dwCv.js";import{u as tt}from"./useDisableForDemo-CWmzrrYY.js";import{C as st}from"./CouponServices-DlRCOaul.js";import{C as nt}from"./CurrencyServices-CGhkZaP1.js";import{b as x,n as c}from"./button-4tHrV-ob.js";var Y={exports:{}},ot=Y.exports,me;function at(){return me||(me=1,(function(w,P){(function(T,y){w.exports=y()})(ot,(function(){return function(T,y,h){y.prototype.isBetween=function(O,A,g,C){var R=h(O),p=h(A),N=(C=C||"()")[0]==="(",F=C[1]===")";return(N?this.isAfter(R,g):!this.isBefore(R,g))&&(F?this.isBefore(p,g):!this.isAfter(p,g))||(N?this.isBefore(R,g):!this.isAfter(R,g))&&(F?this.isAfter(p,g):!this.isBefore(p,g))}}}))})(Y)),Y.exports}var rt=at();const it=ge(rt);var $={exports:{}},ut=$.exports,fe;function dt(){return fe||(fe=1,(function(w,P){(function(T,y){w.exports=y()})(ut,(function(){return function(T,y,h){y.prototype.isToday=function(){var O="YYYY-MM-DD",A=h();return this.format(O)===A.format(O)}}}))})($)),$.exports}var lt=dt();const ct=ge(lt),pt={type:"object",properties:{_id:{type:"string"},name:{type:"object"},description:{type:"object"},icon:{type:"string"},status:{type:"string"}},required:["name"]},mt={type:"object",properties:{status:{type:"string"},title:{type:"object"},name:{type:"object"},variants:{type:"array"},option:{type:"string"},type:{type:"string"}},required:["name","title"]},ft={type:"object",properties:{title:{type:"object"},couponCode:{type:"string"},endTime:{type:"string"},discountPercentage:{type:"number"},minimumAmount:{type:"number"},productType:{type:"string"},logo:{type:"string"},discountType:{type:"object"},status:{type:"string"}},required:["title","couponCode","endTime","status"]},gt={type:"object",properties:{name:{type:"string"},email:{type:"string"}},required:["name","email"]},Jt=w=>{const P=new ze({allErrors:!0}),[T,y]=n.useState(""),[h,O]=n.useState(""),[A,g]=n.useState(""),[C,R]=n.useState(""),[p,N]=n.useState(""),[F,Se]=n.useState(""),[b,ee]=n.useState(""),[D,te]=n.useState(""),[_,se]=n.useState(""),[ye,Ce]=n.useState(""),[U,we]=n.useState(""),[z,he]=n.useState(""),[be,De]=n.useState([]),[Le,Te]=n.useState([]),[Ae,Re]=n.useState([]),[Z,xe]=n.useState(""),[H,Pe]=n.useState(""),[q,Oe]=n.useState(""),[X,Fe]=n.useState(1),[je,ne]=n.useState([]),[Be,Ne]=n.useState(""),[_e,Ue]=n.useState(""),[ve,Ie]=n.useState(""),[S,k]=n.useState([]),[Je,E]=n.useState(""),[qe,M]=n.useState(!1),[G,Ee]=n.useState(""),[K]=n.useState([]),oe=n.useRef(""),ae=n.useRef(""),re=n.useRef(""),ie=n.useRef(""),ue=n.useRef(""),Q=n.useRef(""),de=n.useRef(""),le=n.useRef(""),ce=n.useRef(""),Me=n.useRef(""),pe=n.useRef("");J.extend(it),J.extend(ct);const l=Qe(),{lang:v,setIsUpdate:j,setLoading:m}=n.useContext(We),{globalSetting:B}=Ke(),{handleDisableForDemo:W}=tt(),L=n.useMemo(()=>{const a=new Date;a.setDate(a.getDate()-q);let t=w==null?void 0:w.map(e=>{const r=new Date(e==null?void 0:e.updatedAt).toLocaleString("en-US",{timeZone:B==null?void 0:B.default_time_zone});return{...e,updatedDate:r==="Invalid Date"?"":r}});if(l.pathname==="/dashboard"){const e=t==null?void 0:t.filter(d=>d.status==="Pending"||d.status==="pending");De(e);const r=t==null?void 0:t.filter(d=>d.status==="Processing"||d.status==="processing");Te(r);const s=t==null?void 0:t.filter(d=>d.status==="Delivered"||d.status==="delivered");Re(s);const u=t==null?void 0:t.filter(d=>J(d.createdAt).isToday()),f=u==null?void 0:u.reduce((d,I)=>d+I.total,0);Ne(f);const o=t==null?void 0:t.filter(d=>J(d.createdAt).isBetween(new Date().setDate(new Date().getDate()-30),new Date)),i=o==null?void 0:o.reduce((d,I)=>d+I.total,0);Ue(i);const $e=t==null?void 0:t.reduce((d,I)=>d+I.total,0);Ie($e)}return T&&(t=t.filter(e=>e.parent===T)),h==="Low"&&(t=t.sort((e,r)=>e.price<r.price&&-1)),h==="High"&&(t=t.sort((e,r)=>e.price>r.price&&-1)),A&&(t=t.filter(e=>{var r;return(r=e==null?void 0:e.title)==null?void 0:r.toLowerCase().includes(A.toLowerCase())})),D&&(t=t.filter(e=>{var r,s,u;return((s=(r=e==null?void 0:e.title[v])==null?void 0:r.toLowerCase())==null?void 0:s.includes(D==null?void 0:D.toLowerCase()))||((u=e==null?void 0:e.attribute)==null?void 0:u.toLowerCase().includes(D==null?void 0:D.toLowerCase()))})),b&&(t=t.filter(e=>{var r,s,u;return((s=(r=e==null?void 0:e.name[v])==null?void 0:r.toLowerCase())==null?void 0:s.includes(b==null?void 0:b.toLowerCase()))||((u=e==null?void 0:e.category)==null?void 0:u.toLowerCase().includes(b==null?void 0:b.toLowerCase()))})),H&&(t=t.filter(e=>e.role===H)),C&&(t=t.filter(e=>{var r,s,u;return((r=e==null?void 0:e.name[v])==null?void 0:r.toLowerCase().includes(C.toLowerCase()))||((s=e==null?void 0:e.phone)==null?void 0:s.toLowerCase().includes(C.toLowerCase()))||((u=e==null?void 0:e.email)==null?void 0:u.toLowerCase().includes(C.toLowerCase()))})),p&&(t=t==null?void 0:t.filter(e=>{var r,s,u;return((s=(r=e==null?void 0:e.title[v])==null?void 0:r.toLowerCase())==null?void 0:s.includes(p==null?void 0:p.toLowerCase()))||((u=e==null?void 0:e.couponCode)==null?void 0:u.toLowerCase().includes(p==null?void 0:p.toLowerCase()))})),Z&&(t=t.filter(e=>e.status===Z)),F&&(t=t.filter(e=>e.contact.toLowerCase().includes(F.toLowerCase()))),q&&(t=t.filter(e=>J(e.createdAt).isBetween(a,new Date))),_&&(t=t.filter(e=>{var r,s;return((r=e==null?void 0:e.name)==null?void 0:r.toLowerCase().includes(_.toLowerCase()))||((s=e==null?void 0:e.iso_code)==null?void 0:s.toLowerCase().includes(_.toLowerCase()))})),G&&(t=t.filter(e=>e==null?void 0:e.name.toLowerCase().includes(G.toLowerCase()))),U&&(t=t.filter(e=>e.name.toLowerCase().includes(U.toLowerCase())||e.code.toLowerCase().includes(U.toLowerCase())||e.language_code.toLowerCase().includes(U.toLowerCase()))),z&&(t=t.filter(e=>e.iso_code.toLowerCase().includes(z.toLowerCase()))),t},[q,w,l.pathname,T,h,A,D,b,H,C,p,Z,F,_,G,U,z,Q,B==null?void 0:B.default_time_zone,v]),V=20,Ve=L==null?void 0:L.length,Ye=a=>{Fe(a)};return n.useEffect(()=>{ne(L==null?void 0:L.slice((X-1)*V,X*V))},[L,X,V]),{userRef:re,searchRef:ae,couponRef:ie,orderRef:ue,categoryRef:Q,attributeRef:de,pending:be,processing:Le,delivered:Ae,todayOrder:Be,monthlyOrder:_e,totalOrder:ve,setFilter:y,setSortedField:O,setStatus:xe,setRole:Pe,time:q,zone:ye,setTime:Oe,taxRef:Me,setZone:Ce,filename:Je,countryRef:le,dataTable:je,serviceData:L,country:_,setSearchText:g,setCountry:se,isDisabled:qe,languageRef:ce,currencyRef:oe,shippingRef:pe,setSearchUser:R,setDataTable:ne,setCategoryType:ee,handleChangePage:Ye,totalResults:Ve,resultsPerPage:V,handleOnDrop:a=>{for(let t=0;t<a.length;t++)K.push(a[t].data)},setSearchCoupon:N,setAttributeTitle:te,handleSelectFile:a=>{var r;if(a.preventDefault(),W())return;const t=new FileReader,e=(r=a.target)==null?void 0:r.files[0];e&&e.type==="application/json"?(E(e==null?void 0:e.name),M(!0),console.log("if"),t.readAsText(e,"UTF-8"),t.onload=s=>{let u=JSON.parse(s.target.result),f=[];l.pathname==="/categories"&&(f=u.map(o=>({_id:o._id,id:o.id,status:o.status,name:o.name,description:o.description,parentName:o.parentName,parentId:o.parentId,icon:o.icon}))),l.pathname==="/attributes"&&(f=u.map(o=>({_id:o._id,status:o.status,title:o.title,name:o.name,variants:o.variants,option:o.option,type:o.type}))),l.pathname==="/coupons"&&(f=u.map(o=>({title:o.title,couponCode:o.couponCode,endTime:o.endTime,discountPercentage:o.discountPercentage,minimumAmount:o.minimumAmount,productType:o.productType,logo:o.logo,discountType:o.discountType,status:o.status}))),l.pathname==="/customers"&&(f=u.map(o=>({name:o.name,email:o.email,password:o.password,phone:o.phone}))),k(f)}):e&&e.type==="text/csv"?(E(e==null?void 0:e.name),M(!0),console.log("else if"),t.onload=async s=>{const u=s.target.result,f=await Ge().fromString(u);let o=[];l.pathname==="/categories"&&(o=f.map(i=>({_id:i._id,id:i.id,status:i.status,name:JSON.parse(i.name),description:JSON.parse(i.description),parentName:i.parentName,parentId:i.parentId,icon:i.icon}))),l.pathname==="/attributes"&&(o=f.map(i=>({status:i.status,title:JSON.parse(i.title),name:JSON.parse(i.name),variants:JSON.parse(i.variants),option:i.option,type:i.type}))),l.pathname==="/coupons"&&(o=f.map(i=>({title:JSON.parse(i.title),couponCode:i.couponCode,endTime:i.endTime,discountPercentage:i.discountPercentage?JSON.parse(i.discountPercentage):0,minimumAmount:i.minimumAmount?JSON.parse(i.minimumAmount):0,productType:i.productType,logo:i.logo,status:i.status}))),l.pathname==="/customers"&&(o=f.map(i=>({name:i.name,email:i.email,password:i.password,phone:i.phone}))),k(o)},t.readAsText(e)):(E(e==null?void 0:e.name),M(!0),c("Unsupported file type!"))},handleSubmitUser:a=>{a.preventDefault(),R(re.current.value)},handleSubmitForAll:a=>{a.preventDefault(),g(ae.current.value)},handleSubmitCoupon:a=>{a.preventDefault(),N(ie.current.value)},handleSubmitOrder:a=>{a.preventDefault(),Se(ue.current.value)},handleSubmitCategory:a=>{a.preventDefault(),ee(Q.current.value)},handleSubmitAttribute:a=>{a.preventDefault(),te(de.current.value)},handleUploadProducts:()=>{if(K.length<1)c("Please upload/select csv file first!");else{if(W())return;ke.addAllProducts(K).then(a=>{x(a.message)}).catch(a=>c(a.message))}},handleSubmitCountry:a=>{a.preventDefault(),se(le.current.value)},handleSubmitCurrency:a=>{a.preventDefault(),he(oe.current.value)},handleSubmitShipping:a=>{a.preventDefault(),Ee(pe.current.value)},handleSubmitLanguage:a=>{a.preventDefault(),we(ce.current.value)},handleUploadMultiple:a=>{if(!W())if(S.length>1){if(l.pathname==="/categories"){m(!0);let t=S.map(s=>P.validate(pt,s));const e=s=>s===!0;t.every(e)?Ze.addAllCategory(S).then(s=>{m(!1),j(!0),x(s.message)}).catch(s=>{m(!1),c(s?s.response.data.message:s.message)}):c("Please enter valid data!")}if(l.pathname==="/customers"){m(!0);let t=S.map(s=>P.validate(gt,s));const e=s=>s===!0;t.every(e)?He.addAllCustomers(S).then(s=>{m(!1),j(!0),x(s.message)}).catch(s=>{m(!1),c(s?s.response.data.message:s.message)}):c("Please enter valid data!")}if(l.pathname==="/coupons"){m(!0);let t=S.map(s=>P.validate(ft,s));const e=s=>s===!0;t.every(e)?st.addAllCoupon(S).then(s=>{m(!1),j(!0),x(s.message)}).catch(s=>{m(!1),c(s?s.response.data.message:s.message)}):c("Please enter valid data!")}if(l.pathname==="/attributes"){m(!0);let t=S.map(s=>P.validate(mt,s));const e=s=>s===!0;t.every(e)?Xe.addAllAttributes(S).then(s=>{m(!1),j(!0),x(s.message)}).catch(s=>{m(!1),c(s?s.response.data.message:s.message)}):c("Please enter valid data!")}l.pathname==="/languages"&&et.addAllLanguage(S).then(t=>{j(!0),x(t.message)}).catch(t=>c(t?t.response.data.message:t.message)),l.pathname==="/currencies"&&nt.addAllCurrency(S).then(t=>{j(!0),x(t.message)}).catch(t=>c(t?t.response.data.message:t.message))}else c("Please select a valid .JSON/.CSV/.XLS file first!")},handleRemoveSelectFile:a=>{E(""),k([]),setTimeout(()=>M(!1),1e3)}}};export{ct as a,it as i,Jt as u};
