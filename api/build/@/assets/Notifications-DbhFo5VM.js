import{j as t,r,m as $}from"./index-BmZ_dwCv.js";import{n as h,B as b,b as u}from"./button-4tHrV-ob.js";import{C as w,a as k}from"./card-z1qiUGvD.js";import{T as O,a as z,e as L,c as W,f as y}from"./table-DqTgYDcX.js";import{u as q,N as c,v as A,f as D,S as G,A as H,i as J,j as K,B as S,D as Q}from"./Layout-B1bU_74f.js";import{P as V}from"./PageTitle-LqzkoK1q.js";import"./index-CWe8m2Sk.js";const C=({id:d,name:o,type:x,handleClick:f,isChecked:g})=>t.jsx("input",{id:d,name:o,type:x,onChange:f,checked:g}),as=()=>{const[d,o]=r.useState([]),[x,f]=r.useState(0),[g,l]=r.useState(0),[T,p]=r.useState(2),[n,m]=r.useState([]),[j,U]=r.useState(!1),{showDateTimeFormat:I}=q(),M=async a=>{var i,e;try{await c.updateStatusNotification(a,{status:"read"});const s=await c.getAllNotification();o(s==null?void 0:s.notifications),l(s==null?void 0:s.totalUnreadDoc),window.location.reload(!1)}catch(s){h(((e=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:e.message)||(s==null?void 0:s.message))}},B=async a=>{var i,e;try{await c.deleteNotification(a);const s=await c.getAllNotification();o(s==null?void 0:s.notifications),l(s==null?void 0:s.totalUnreadDoc),f(s==null?void 0:s.totalDoc)}catch(s){h(((e=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:e.message)||(s==null?void 0:s.message))}},F=async a=>{var i,e;try{const s=await c.getAllNotification(a);o(N=>[...N,...s==null?void 0:s.notifications]),l(s==null?void 0:s.totalUnreadDoc),p(N=>N+1)}catch(s){h(((e=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:e.message)||(s==null?void 0:s.message))}},_=async()=>{var a,i;try{const e=await c.updateManyStatusNotification({ids:n,status:"read"});m([]),u(e.message),p(1);const s=await c.getAllNotification();o(s==null?void 0:s.notifications),l(s==null?void 0:s.totalUnreadDoc)}catch(e){h(((i=(a=e==null?void 0:e.response)==null?void 0:a.data)==null?void 0:i.message)||(e==null?void 0:e.message))}},E=async()=>{var a,i;try{const e=await c.deleteManyNotification({ids:n});u(e.message),m([]),p(1);const s=await c.getAllNotification();o(s==null?void 0:s.notifications),l(s==null?void 0:s.totalUnreadDoc)}catch(e){h(((i=(a=e==null?void 0:e.response)==null?void 0:a.data)==null?void 0:i.message)||(e==null?void 0:e.message))}},v=()=>{U(!j),m(d==null?void 0:d.map(a=>a._id)),j&&m([])},P=a=>{const{id:i,checked:e}=a.target;m([...n,i]),e||m(n.filter(s=>s!==i))};return r.useEffect(()=>{(async()=>{var a,i;try{const e=await c.getAllNotification();o(e==null?void 0:e.notifications),l(e==null?void 0:e.totalUnreadDoc),f(e==null?void 0:e.totalDoc),p(1)}catch(e){h(((i=(a=e==null?void 0:e.response)==null?void 0:a.data)==null?void 0:i.message)||(e==null?void 0:e.message))}})()},[]),t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"lg:flex lg:items-center lg:justify-between py-8 gap-2",children:t.jsx("div",{className:"min-w-0 flex-1",children:t.jsx(V,{children:"Notifications"})})}),t.jsx(w,{className:"shadow-sm overflow-hidden bg-white dark:bg-gray-800 mb-5",children:t.jsxs(k,{className:"md:p-6 p-4 flex justify-between",children:[t.jsx("div",{className:"",children:t.jsxs(b,{disabled:(n==null?void 0:n.length)<1,onClick:_,children:[t.jsx("span",{className:"mr-2",children:t.jsx(A,{})}),"Mark is read"]})}),t.jsx("div",{className:"",children:t.jsxs(b,{disabled:(n==null?void 0:n.length)<1,onClick:E,variant:"delete",children:[t.jsx("span",{className:"mr-3",children:t.jsx(D,{})}),"Delete"]})})]})}),t.jsx(w,{className:"shadow-sm overflow-hidden bg-white dark:bg-gray-800 mb-5",children:t.jsxs(k,{className:"p-0",children:[t.jsx("div",{className:"p-4 dark:text-gray-300",children:t.jsxs("p",{className:"text-sm font-semibold text-teal-700",children:["Unread Notification (",g,")"]})}),t.jsxs("div",{className:"border rounded-md",children:[t.jsxs("div",{className:"bg-gray-200 border-gray-400 py-2 sm:px-6 px-4 dark:bg-gray-700 dark:text-gray-400 flex justify-between",children:[t.jsxs("div",{className:"flex",children:[t.jsx(C,{type:"checkbox",name:"selectAll",id:"selectAll",handleClick:v,isChecked:j}),t.jsx("p",{className:"text-xs font-semibold text-gray-500 my-auto dark:text-gray-300 ml-6 uppercase",children:"Notification"})]}),t.jsx("div",{className:"text-right",children:t.jsx("p",{className:"text-xs font-semibold text-gray-500 my-auto dark:text-gray-300 mr-2 uppercase",children:"Action"})})]}),t.jsx("div",{className:"w-full lg:h-lg md:h-sm h-md relative md:p-6 p-2",children:t.jsx(G,{className:"scrollbar-hide",children:t.jsxs(O,{className:"border-none p-2",children:[t.jsx(z,{children:t.jsx(L,{className:"w-full h-440",children:d.map((a,i)=>t.jsxs(W,{className:"border-none",children:[t.jsx(y,{style:{padding:0},children:t.jsx(C,{type:"checkbox",name:a==null?void 0:a._id,id:a._id,handleClick:P,isChecked:n==null?void 0:n.includes(a._id)})}),t.jsx(y,{style:{paddingRight:0},children:t.jsxs($,{to:a.productId?`/product/${a.productId}`:`/order/${a.orderId}`,className:"flex items-center",onClick:()=>M(a._id),children:[t.jsxs(H,{className:"mr-2 md:block bg-gray-50 border border-gray-200 h-8 w-8",children:[t.jsx(J,{src:a.image,alt:"notification"}),t.jsx(K,{children:"N"})]}),t.jsxs("div",{className:"notification-content",children:[t.jsx("div",{className:"md:inline-block hidden",children:t.jsx("h6",{className:"font-medium text-gray-500",children:a==null?void 0:a.message})}),t.jsx("div",{className:"md:hidden",children:t.jsx("h6",{className:"font-medium text-gray-500",children:(a==null?void 0:a.message.substring(0,33))+"..."})}),t.jsxs("p",{className:"flex items-center text-xs text-gray-400",children:[a.productId?t.jsx(S,{variant:"danger",children:"Stock Out"}):t.jsx(S,{variant:"success",children:"New Order"}),t.jsx("span",{className:"ml-2",children:I(a==null?void 0:a.createdAt)})]})]}),a.status==="unread"&&t.jsx("span",{className:"px-2 md:flex hidden focus:outline-none text-emerald-600",children:t.jsx("img",{src:Q,width:12,height:12,alt:"ellipse",className:"w-3 h-3 text-emerald-600"})})]})}),t.jsx(y,{className:"text-right",style:{padding:`${window.innerWidth<420?"0":"0.5rem"}`},children:t.jsxs("div",{className:"group inline-block relative",children:[t.jsx("button",{onClick:()=>B(a._id),type:"button",className:"px-2 group-hover:text-blue-500 text-red-500 focus:outline-none",children:t.jsx(D,{})}),t.jsx("div",{className:"absolute hidden group-hover:inline-block bg-gray-50 dark:text-white mr-8 mb-1 right-0 z-50 px-3 py-2 text-sm font-medium text-red-600 rounded-lg shadow-sm tooltip dark:bg-gray-700",children:"Delete"})]})})]},i+1))})}),t.jsx("div",{children:x>5&&d.length!==x?t.jsx("div",{className:"text-center py-2",children:t.jsx("button",{onClick:()=>F(T+1),type:"button",className:"focus:outline-none text-blue-700 hover:underline transition ease-out duration-200 dark:text-gray-400",children:"See more notifications"})}):null})]})})})]})]})})]})};export{as as default};
