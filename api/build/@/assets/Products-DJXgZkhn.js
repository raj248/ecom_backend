import{x as V,j as e,z as B,m as le,r as C,S as H,l as z}from"./index-BmZ_dwCv.js";import{b as M,n as v,B as F}from"./button-4tHrV-ob.js";import{C as ie,a as re}from"./card-z1qiUGvD.js";import{I as ne}from"./input-C0BdUGB3.js";import{a as oe,P as I,c as ce,b as de,C as me}from"./ProductServices-afE79VKB.js";import{S as $,a as q,b as W,c as Z,d as h}from"./select-B6txXpwi.js";import{e as he,c as G,f as j,T as xe,a as ge,b as je,d as p}from"./table-DqTgYDcX.js";import{u as K,A as R,i as L,j as _,B as E,k as pe,e as fe,f as be,g as ue}from"./Layout-B1bU_74f.js";import{u as Q}from"./useAsync-xcASmSVa.js";import{u as X,M as ye}from"./DrawerButton-Cgm6zT_g.js";import{U as we}from"./UploadMany-J0kUphxL.js";import{N as Se}from"./NotFound-DPkmTFlo.js";import{P as Ne}from"./PageTitle-LqzkoK1q.js";import{C as Y,S as ve,B as Ce}from"./ShowHideButton-CM1A-hEd.js";import{E as Pe,D as ke}from"./EditDeleteButton-DWncACV1.js";import{T as De}from"./Tooltip-Bb6l2jS1.js";import{P as Te}from"./ProductDrawer-b1VYk31X.js";import{u as Ae}from"./useDisableForDemo-CWmzrrYY.js";import{T as Fe}from"./TableLoading-B5kOxqdm.js";import{A as Oe}from"./AnimatedContent-BNKJlQXC.js";import"./index-C148XJoK.js";import"./Combination-v4s5Rmjm.js";import"./index-CWe8m2Sk.js";import"./tslib.es6-BGws65QO.js";import"./floating-ui.dom-BM6icrOT.js";import"./SelectLanguageTwo-D8KAIgW8.js";import"./spinner-CkndCogW.js";import"./exportFromJSON-BvevaQwb.js";import"./ParentCategory-gD9tabZx.js";import"./index.esm-DazwP4qc.js";import"./LabelArea-CDILq1N9.js";import"./label-C6IWixiq.js";import"./SwitchToggle-BjyUJm8q.js";import"./index.prod-DYWWLFcb.js";import"./textarea-CEbUnO4R.js";import"./CouponServices-DlRCOaul.js";import"./CurrencyServices-CGhkZaP1.js";import"./AdminServices-LtusNjKA.js";import"./index-BdrnRTgM.js";import"./InputArea-l9xTjbBj.js";import"./InputValue-C4c78urY.js";import"./useTranslationValue-BbCbvZPg.js";import"./Uploader-CWHO3hsY.js";import"./_commonjs-dynamic-modules-dt42qxfv.js";const Ue=({products:x})=>{const{handleModalOpen:y,handleUpdate:c}=X(),{selectedIds:g,handleSelect:d}=V(),{currency:f,showingTranslateValue:n,getNumberTwo:b}=K();return e.jsx(e.Fragment,{children:e.jsx(he,{children:x==null?void 0:x.map((s,P)=>{var t,u,k,D,w,S,T;return e.jsxs(G,{children:[e.jsx(j,{children:e.jsx(Y,{type:"checkbox",id:s._id,handleSelect:d,name:(t=s==null?void 0:s.title)==null?void 0:t.en,isChecked:g==null?void 0:g.includes(s._id)})}),e.jsx(j,{children:e.jsxs("div",{className:"flex items-center",children:[s!=null&&s.image[0]?e.jsxs(R,{className:"hidden p-1 mr-2 md:block bg-gray-50 shadow-none",children:[e.jsx(L,{src:s==null?void 0:s.image[0],alt:"product"}),e.jsx(_,{children:"P"})]}):e.jsxs(R,{children:[e.jsx(L,{src:"https://res.cloudinary.com/ahossain/image/upload/v1655097002/placeholder_kvepfp.png",alt:"product"}),e.jsx(_,{children:"P"})]}),e.jsx("div",{children:e.jsx("h2",{className:`text-sm font-medium ${(s==null?void 0:s.title.length)>30?"wrap-long-title":""}`,children:(u=n(s==null?void 0:s.title))==null?void 0:u.substring(0,28)})})]})}),e.jsx(j,{children:e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-200",children:n((k=s==null?void 0:s.category)==null?void 0:k.name)})}),e.jsx(j,{children:e.jsxs("span",{className:"text-sm font-semibold",children:[f,s!=null&&s.isCombination?b((D=s==null?void 0:s.variants[0])==null?void 0:D.originalPrice):b((w=s==null?void 0:s.prices)==null?void 0:w.originalPrice)]})}),e.jsx(j,{children:e.jsxs("span",{className:"text-sm font-semibold",children:[f,s!=null&&s.isCombination?b((S=s==null?void 0:s.variants[0])==null?void 0:S.price):b((T=s==null?void 0:s.prices)==null?void 0:T.price)]})}),e.jsx(j,{children:e.jsx("span",{className:"text-sm",children:s.stock})}),e.jsx(j,{children:s.stock>0?e.jsx(E,{variant:"success",children:B("Selling")}):e.jsx(E,{variant:"danger",children:B("SoldOut")})}),e.jsx(j,{children:e.jsx(le,{to:`/product/${s._id}`,className:"flex justify-center text-gray-400 hover:text-emerald-600",children:e.jsx(De,{id:"view",Icon:pe,title:B("DetailsTbl"),bgColor:"#10B981"})})}),e.jsx(j,{className:"text-center",children:e.jsx(ve,{id:s._id,status:s.status})}),e.jsx(j,{children:e.jsx(Pe,{id:s._id,product:s,selectedIds:g,handleUpdate:c,handleModalOpen:y,title:n(s==null?void 0:s.title)})})]},P+1)})})})},Be={type:"object",properties:{categories:{type:"array"},image:{type:"array"},tag:{type:"array"},variants:{type:"array"},show:{type:"array"},status:{type:"string"},prices:{type:"object"},isCombination:{type:"boolean"},title:{type:"object"},productId:{type:"string"},slug:{type:"string"},category:{type:"object"},stock:{type:"number"},description:{type:"object"}},required:["categories","category","prices","title"]},Ie=x=>{const y=new oe({allErrors:!0}),{setLoading:c,setIsUpdate:g}=C.useContext(H),[d]=C.useState([]),[f,n]=C.useState([]),[b,s]=C.useState(""),[P,t]=C.useState(!1),{handleDisableForDemo:u}=Ae();return{data:x,filename:b,isDisabled:P,handleSelectFile:async o=>{var N;o.preventDefault();const m=new FileReader,l=(N=o.target)==null?void 0:N.files[0];l&&l.type==="application/json"?(s(l==null?void 0:l.name),t(!0),m.readAsText(l,"UTF-8"),m.onload=a=>{const A=JSON.parse(a.target.result).map(i=>({categories:i.categories,image:i.image,barcode:i.barcode,tag:i.tag,variants:i.variants,status:i.status,prices:i.prices,isCombination:i.isCombination,title:i.title,productId:i.productId,slug:i.slug,sku:i.sku,category:i.category,stock:i.stock,description:i.description}));n(A)}):l&&l.type==="text/csv"?(s(l==null?void 0:l.name),t(!0),m.onload=async a=>{const O=a.target.result,i=(await ce().fromString(O)).map(r=>({categories:JSON.parse(r.categories),image:JSON.parse(r.image),barcode:r.barcode,tag:JSON.parse(r.tag),variants:JSON.parse(r.variants),status:r.status,prices:JSON.parse(r.prices),isCombination:JSON.parse(r.isCombination.toLowerCase()),title:JSON.parse(r.title),productId:r.productId,slug:r.slug,sku:r.sku,category:JSON.parse(r.category),stock:JSON.parse(r.stock),description:JSON.parse(r.description)}));n(i)},m.readAsText(l)):(s(l==null?void 0:l.name),t(!0),v("Unsupported file type!"))},serviceData:x,handleOnDrop:o=>{for(let m=0;m<o.length;m++)d.push(o[m].data)},handleUploadProducts:()=>{if(!u())if(d.length<1)v("Please upload/select csv file first!");else{if(u())return;I.addAllProducts(d).then(o=>{M(o.message)}).catch(o=>v(o.message))}},handleRemoveSelectFile:o=>{s(""),n([]),setTimeout(()=>t(!1),1e3)},handleUploadMultiple:o=>{if(!u())if(f.length>1){c(!0);let m=f.map(a=>y.validate(Be,a));const l=a=>a===!0;m.every(l)?I.addAllProducts(f).then(a=>{g(!0),c(!1),M(a.message)}).catch(a=>{c(!1),v(a.message)}):(c(!1),v("Please enter valid data!"))}else c(!1),v("Please select a valid json, csv & xls file first!")}}},Je=({setCategory:x})=>{const{t:y}=z(),{data:c}=Q(de.getAllCategories),{showingTranslateValue:g}=K();return e.jsx(e.Fragment,{children:e.jsxs($,{onValueChange:x,children:[e.jsx(q,{children:e.jsx(W,{placeholder:y("Category")})}),e.jsxs(Z,{children:[e.jsx(h,{value:"All",children:"All"}),c==null?void 0:c.map(d=>e.jsx(h,{value:d._id,children:g(d==null?void 0:d.name)},d._id))]})]})})},ks=()=>{const{title:x,handleDeleteMany:y,handleUpdateMany:c}=X(),{open:g,setOpen:d,selectedId:f,selectedIds:n,isCheckAll:b,handleSelectAll:s,toggleDrawer:P}=V(),{t}=z(),{lang:u,category:k,searchText:D,setCategory:w,searchRef:S,currentPage:T,sortedField:J,limitData:o,setSortedField:m,handleChangePage:l,handleSubmitForAll:N}=C.useContext(H),{data:a,loading:O,error:A}=Q(()=>I.getAllProducts({page:T,limit:o,category:k,title:D,price:J})),i=()=>{w(""),m(""),S.current.value=""},{filename:r,isDisabled:ee,serviceData:U,handleSelectFile:se,handleUploadMultiple:te,handleRemoveSelectFile:ae}=Ie(a==null?void 0:a.products);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between py-4 lg:py-8 gap-4 lg:gap-2",children:[e.jsx("div",{className:"min-w-0 flex-1",children:e.jsx(Ne,{children:t("ProductsPage")})}),e.jsxs("form",{onSubmit:N,className:"flex flex-col sm:flex-row lg:flex-row gap-2 lg:ml-4",children:[e.jsx("div",{className:"w-full sm:w-auto",children:e.jsx(we,{title:"Products",filename:r,isDisabled:ee,totalDoc:a==null?void 0:a.totalDoc,handleSelectFile:se,handleUploadMultiple:te,handleRemoveSelectFile:ae})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs(F,{variant:"bulkAction",disabled:n.length<1,onClick:()=>c(n),className:"w-full sm:w-auto",children:[e.jsx("span",{children:e.jsx(fe,{})}),t("BulkAction")]}),e.jsxs(F,{variant:"delete",disabled:(n==null?void 0:n.length)<1,onClick:()=>y(n),className:"w-full sm:w-auto",children:[e.jsx("span",{children:e.jsx(be,{})}),t("Delete")]}),e.jsxs(F,{variant:"create",onClick:P,className:"w-full sm:w-auto",children:[e.jsx("span",{children:e.jsx(ue,{})}),t("AddProduct")]})]})]})]}),e.jsx(ke,{open:g,title:x,ids:n,onOpenChange:()=>d(!1)}),e.jsx(Ce,{ids:n,title:"Products"}),e.jsx(ye,{children:e.jsx(Te,{id:f})}),e.jsx(Oe,{children:e.jsx(ie,{className:"min-w-0 shadow-sm overflow-hidden bg-white dark:bg-gray-800 rounded-t-lg rounded-0 mb-4",children:e.jsxs(re,{className:"p-5",children:[e.jsxs("form",{onSubmit:N,className:"pb-5 flex flex-col sm:flex-row gap-3 sm:gap-4",children:[e.jsxs("div",{className:"w-full sm:flex-1 relative",children:[e.jsx(ne,{ref:S,type:"search",name:"search",placeholder:"Search Product",className:"w-full"}),e.jsx("button",{type:"submit",className:"absolute right-1 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),e.jsx("div",{className:"w-full sm:flex-1",children:e.jsx(Je,{setCategory:w,lang:u})}),e.jsx("div",{className:"w-full sm:flex-1",children:e.jsxs($,{onValueChange:m,children:[e.jsx(q,{className:"w-full",children:e.jsx(W,{placeholder:t("Price")})}),e.jsxs(Z,{children:[e.jsx(h,{value:"low",children:t("LowtoHigh")}),e.jsx(h,{value:"high",children:t("HightoLow")}),e.jsx(h,{value:"published",children:t("Published")}),e.jsx(h,{value:"unPublished",children:t("Unpublished")}),e.jsx(h,{value:"status-selling",children:t("StatusSelling")}),e.jsx(h,{value:"status-out-of-stock",children:t("StatusStock")}),e.jsx(h,{value:"date-added-asc",children:t("DateAddedAsc")}),e.jsx(h,{value:"date-added-desc",children:t("DateAddedDesc")}),e.jsx(h,{value:"date-updated-asc",children:t("DateUpdatedAsc")}),e.jsx(h,{value:"date-updated-desc",children:t("DateUpdatedDesc")})]})]})}),e.jsxs("div",{className:"flex gap-2 sm:flex-shrink-0 sm:min-w-[160px]",children:[e.jsx(F,{className:"h-10 flex-1 sm:min-w-[75px]",type:"submit",variant:"export",children:"Filter"}),e.jsx(F,{className:"h-10 flex-1 sm:min-w-[75px]",variant:"outline",onClick:i,type:"reset",children:e.jsx("span",{className:"text-black dark:text-gray-200",children:"Reset"})})]})]}),O?e.jsx(Fe,{row:12,col:7,width:160,height:20}):A?e.jsx("span",{className:"text-center mx-auto text-red-500",children:A}):(U==null?void 0:U.length)!==0?e.jsxs("div",{children:[e.jsx(xe,{className:"mb-4 rounded-b-lg",children:e.jsxs(ge,{children:[e.jsx(je,{children:e.jsxs(G,{children:[e.jsx(p,{children:e.jsx(Y,{type:"checkbox",name:"selectAll",id:"selectAll",isChecked:b,handleSelect:()=>s(a==null?void 0:a.products)})}),e.jsx(p,{children:t("ProductNameTbl")}),e.jsx(p,{children:t("CategoryTbl")}),e.jsx(p,{children:t("PriceTbl")}),e.jsx(p,{children:"Sale Price"}),e.jsx(p,{children:t("StockTbl")}),e.jsx(p,{children:t("StatusTbl")}),e.jsx(p,{className:"text-center",children:t("DetailsTbl")}),e.jsx(p,{className:"text-center",children:t("PublishedTbl")}),e.jsx(p,{className:"text-right",children:t("ActionsTbl")})]})}),e.jsx(Ue,{products:a==null?void 0:a.products})]})}),e.jsx("div",{children:e.jsx(me,{resultsperpage:o,totalresults:a==null?void 0:a.totalDoc,onChange:l,label:"Product Page Navigation"})})]}):e.jsx(Se,{title:"Product"})]})})})]})};export{ks as default};
