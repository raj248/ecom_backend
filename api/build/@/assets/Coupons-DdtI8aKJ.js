import{r as f,S as re,x as z,y as ie,j as e,z as o,l as ne}from"./index-lrQuldHs.js";import{n as Y,b as $,B as U}from"./button-rh3FTULs.js";import{C as oe,a as de}from"./card-w6jK4kZ9.js";import{I as ee}from"./input-DxgA4gbo.js";import{C as me}from"./ProductServices-DkrntO0G.js";import{e as ce,c as se,f as w,T as pe,a as xe,b as ue,d as v}from"./table-pH1NcXB9.js";import{u as ae,d as q,l as he,A as Q,i as W,j as Z,B as G,e as ge,f as je,g as fe}from"./Layout-zjBccTHe.js";import{u as be}from"./useAsync-BoRl3kkI.js";import{u as Ce}from"./useFilter-CTY6t_y8.js";import{N as ye}from"./NotFound-DffgNZ-O.js";import{U as Te}from"./UploadMany-BA7CJfP3.js";import{C as B}from"./CouponServices-DZWPN_Z6.js";import{T as J,D as Ne,u as te,M as we}from"./DrawerButton-CHM5Wu-i.js";import{P as ve}from"./PageTitle-DEDGWyYG.js";import{E as Se,D as Ae}from"./EditDeleteButton-BFQAVewg.js";import{u as ke,E as A}from"./index.esm-BUE4Z1sU.js";import{I as K}from"./InputArea-C6cF93jC.js";import{I as X}from"./InputValue-CqCA7uY_.js";import{L as S}from"./LabelArea-CL5vBgQk.js";import{U as De}from"./Uploader-XL13W98r.js";import{u as Pe}from"./useTranslationValue-2zmYr2dJ.js";import{S as Fe}from"./SwitchToggle-BZHbvCGz.js";import{a as Ee}from"./index.prod-Ca2g6A5e.js";import{T as Ue}from"./TableLoading-BpKh234J.js";import{C as le,S as Be,B as Me}from"./ShowHideButton-B5Ky8xjG.js";import{A as Ie}from"./AnimatedContent-DSnt0TWS.js";import"./index-C148XJoK.js";import"./index-BOuINoA5.js";import"./useDisableForDemo-dHOka9Cq.js";import"./CurrencyServices-BtWGRbQW.js";import"./exportFromJSON-BvevaQwb.js";import"./spinner-CkndCogW.js";import"./Tooltip-D68gOM7t.js";import"./floating-ui.dom-BM6icrOT.js";import"./SelectLanguageTwo-CEDNWkHE.js";import"./Combination-DMBpnunk.js";import"./tslib.es6-BGws65QO.js";import"./AdminServices-B69j88RY.js";import"./label-D0mdihLM.js";import"./_commonjs-dynamic-modules-BeaYaW73.js";import"./ParentCategory-DqAAqud_.js";import"./select-7doUwPnS.js";import"./textarea-CE3Qtp6r.js";const Ve=a=>{const{setIsUpdate:r,lang:u}=f.useContext(re),{openDrawer:x,closeDrawer:t}=z(),[d,b]=f.useState(""),[i,h]=f.useState("en"),[c,C]=f.useState({}),[s,p]=f.useState(!1),[g,j]=f.useState(!1),[k,y]=f.useState(!1),{currency:D}=ae(),P=ie(),{handlerTextTranslateHandler:M}=Pe(),{control:I,register:V,handleSubmit:L,setValue:n,clearErrors:T,formState:{errors:R}}=ke(),_=async m=>{var F,E;try{y(!0);const l={title:{...await M(m.title,i,c==null?void 0:c.title),[i]:m.title},couponCode:m.couponCode,endTime:m.endTime,minimumAmount:m.minimumAmount,logo:d,lang:i,status:s?"show":"hide",discountType:{type:g?"percentage":"fixed",value:m.discountPercentage},productType:m.productType};if(a){const H=await B.updateCoupon(a,l);r(!0),y(!1),$(H.message),t(),P.invalidateQueries(["coupons"])}else{const H=await B.addCoupon(l);r(!0),y(!1),$(H.message),t(),P.invalidateQueries(["coupons"])}}catch(N){Y(((E=(F=N==null?void 0:N.response)==null?void 0:F.data)==null?void 0:E.message)||(N==null?void 0:N.message)),y(!1),t()}},O=m=>{h(m),Object.keys(c).length>0&&n("title",c.title[m||"en"])};return f.useEffect(()=>{if(!a){C({}),n("title"),n("productType"),n("couponCode"),n("endTime"),n("discountPercentage"),n("minimumAmount"),b(""),T("title"),T("productType"),T("couponCode"),T("endTime"),T("discountPercentage"),T("minimumAmount"),h(u),n("language",i);return}},[n,a,x,T,u]),f.useEffect(()=>{a&&(async()=>{var m,F,E,N;try{const l=await B.getCouponById(a);l&&(C(l),n("title",l.title[i||"en"]),n("productType",l.productType),n("couponCode",l.couponCode),n("endTime",q(l.endTime).format("YYYY-MM-DD HH:mm")),n("discountPercentage",(m=l.discountType)==null?void 0:m.value),n("minimumAmount",l.minimumAmount),p(l.status==="show"),j(((F=l.discountType)==null?void 0:F.type)==="percentage"),b(l.logo))}catch(l){Y(((N=(E=l==null?void 0:l.response)==null?void 0:E.data)==null?void 0:N.message)||(l==null?void 0:l.message))}})()},[a]),{language:i,control:I,register:V,handleSubmit:L,onSubmit:_,errors:R,setImageUrl:b,imageUrl:d,published:s,setPublished:p,currency:D,discountType:g,isSubmitting:k,setDiscountType:j,handleSelectLanguage:O}},Le=({title:a,handleProcess:r,processOption:u,product:x,handleIsCombination:t})=>e.jsx(e.Fragment,{children:e.jsx("div",{className:`${x?"mb-3 flex flex-wrap justify-end items-center mr-8":"mb-3"}`,children:e.jsxs("div",{className:"flex flex-wrap items-center",children:[x?e.jsx("label",{className:"block text-base font-normal text-orange-500 dark:text-orange-400 mx-4",children:"Does this product have variants?"}):e.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1",children:a}),e.jsx(Ee,{onChange:x?t:r,checked:u,className:"react-switch",uncheckedIcon:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",fontSize:14,color:"white",paddingRight:45,paddingTop:1},children:"Fixed"}),width:125,height:33,handleDiameter:28,offColor:"#E53E3E",onColor:"#2F855A",checkedIcon:e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",fontSize:14,color:"white",paddingLeft:50,paddingTop:1},children:"Percentage"})})]})})}),Re=({id:a})=>{const{register:r,language:u,handleSubmit:x,onSubmit:t,errors:d,setImageUrl:b,imageUrl:i,published:h,setPublished:c,currency:C,discountType:s,setDiscountType:p,isSubmitting:g,handleSelectLanguage:j}=Ve(a);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full relative  p-6 border-b border-gray-100 bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 ",children:a?e.jsx(J,{register:r,language:u,handleSelectLanguage:j,title:o("UpdateCoupon"),description:o("UpdateCouponDescription")}):e.jsx(J,{register:r,language:u,handleSelectLanguage:j,title:o("AddCoupon"),description:o("AddCouponDescription")})}),e.jsx(he.Scrollbars,{className:"w-full md:w-7/12 lg:w-8/12 xl:w-8/12 relative dark:bg-gray-700 dark:text-gray-200",children:e.jsxs("form",{onSubmit:x(t),children:[e.jsxs("div",{className:"px-6 pt-8 flex-grow scrollbar-hide w-full max-h-full pb-40",children:[e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(S,{label:o("CouponBannerImage")}),e.jsx("div",{className:"col-span-8 sm:col-span-4",children:e.jsx(De,{imageUrl:i,setImageUrl:b,folder:"coupon",targetWidth:238,targetHeight:238})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(S,{label:o("CampaignName")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(K,{required:!0,register:r,label:"Coupon title",name:"title",type:"text",placeholder:o("CampaignName")}),e.jsx(A,{errorName:d.title})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(S,{label:o("CampaignCode")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(K,{required:!0,register:r,label:"Coupon Code",name:"couponCode",type:"text",placeholder:o("CampaignCode")}),e.jsx(A,{errorName:d.couponCode})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(S,{label:o("CouponValidityTime")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(ee,{...r("endTime",{required:"Coupon Validation End Time"}),label:"Coupon Validation End Time",name:"endTime",type:"datetime-local",placeholder:o("CouponValidityTime")}),e.jsx(A,{errorName:d.endTime})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(S,{label:o("DiscountType")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(Le,{handleProcess:p,processOption:s}),e.jsx(A,{errorName:d.discountType})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(S,{label:o("Discount")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(X,{product:!0,required:!0,register:r,maxValue:s?99:1e3,minValue:1,label:"Discount",name:"discountPercentage",type:"number",placeholder:s?"Percentage":"Fixed Amount",currency:s?"%":C}),e.jsx(A,{errorName:d.discountPercentage})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(S,{label:o("MinimumAmount")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(X,{product:!0,required:!0,register:r,maxValue:2e5,minValue:100,label:"Minimum Amount",name:"minimumAmount",type:"number",placeholder:o("MinimumAmountPlasholder"),currency:C}),e.jsx(A,{errorName:d.minimumAmount})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-3 md:gap-5 xl:gap-6 lg:gap-6 mb-6",children:[e.jsx(S,{label:o("Published")}),e.jsxs("div",{className:"col-span-8 sm:col-span-4",children:[e.jsx(Fe,{handleProcess:c,processOption:h}),e.jsx(A,{errorName:d.productType})]})]})]}),e.jsx(Ne,{id:a,title:"Coupon",isSubmitting:g})]})})]})},_e=({coupons:a})=>{const{selectedIds:r,handleSelect:u}=z(),{handleModalOpen:x,handleUpdate:t}=te(),{currency:d,showDateFormat:b,globalSetting:i,showingTranslateValue:h}=ae(),[c,C]=f.useState([]);return f.useEffect(()=>{const s=a==null?void 0:a.map(p=>{const g=new Date(p==null?void 0:p.updatedAt).toLocaleString("en-US",{timeZone:i==null?void 0:i.default_time_zone});return{...p,updatedDate:g}});C(s)},[a,i==null?void 0:i.default_time_zone]),e.jsx(e.Fragment,{children:e.jsx(ce,{children:c==null?void 0:c.map((s,p)=>{var g,j,k,y,D;return e.jsxs(se,{children:[e.jsx(w,{children:e.jsx(le,{id:s._id,type:"checkbox",name:(g=s==null?void 0:s.title)==null?void 0:g.en,handleSelect:u,isChecked:r==null?void 0:r.includes(s._id)})}),e.jsxs(w,{children:[e.jsxs("div",{className:"flex items-center",children:[s!=null&&s.logo?e.jsxs(Q,{className:"hidden p-1 mr-2 md:block bg-gray-50 shadow-none",children:[e.jsx(W,{src:s==null?void 0:s.logo,alt:"product"}),e.jsx(Z,{children:"C"})]}):e.jsxs(Q,{children:[e.jsx(W,{src:"https://res.cloudinary.com/ahossain/image/upload/v1655097002/placeholder_kvepfp.png",alt:"product"}),e.jsx(Z,{children:"C"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm",children:h(s==null?void 0:s.title)})," "]})]})," "]}),e.jsxs(w,{children:[" ",e.jsxs("span",{className:"text-sm",children:[" ",s.couponCode]})," "]}),(j=s==null?void 0:s.discountType)!=null&&j.type?e.jsxs(w,{children:[" ",e.jsxs("span",{className:"text-sm font-semibold",children:[" ",((k=s==null?void 0:s.discountType)==null?void 0:k.type)==="percentage"?`${(y=s==null?void 0:s.discountType)==null?void 0:y.value}%`:`${d}${(D=s==null?void 0:s.discountType)==null?void 0:D.value}`]})," "]}):e.jsxs(w,{children:[" ",e.jsx("span",{className:"text-sm font-semibold",children:" "})," "]}),e.jsx(w,{className:"text-center",children:e.jsx(Be,{id:s._id,status:s.status})}),e.jsx(w,{children:e.jsx("span",{className:"text-sm",children:b(s.startTime)})}),e.jsx(w,{children:e.jsx("span",{className:"text-sm",children:b(s.endTime)})}),e.jsx(w,{className:"align-middle ",children:q().isAfter(q(s.endTime))?e.jsx(G,{variant:"error",children:"Expired"}):e.jsx(G,{variant:"success",children:"Active"})}),e.jsx(w,{children:e.jsx(Se,{id:s==null?void 0:s._id,selectedIds:r,handleUpdate:t,handleModalOpen:x,title:h(s==null?void 0:s.title)})})]},p+1)})})})},Ps=()=>{const{t:a}=ne(),{open:r,setOpen:u,selectedId:x,selectedIds:t,isCheckAll:d,toggleDrawer:b,handleSelectAll:i}=z(),{data:h,loading:c,error:C}=be(B.getAllCoupons),{title:s,handleDeleteMany:p,handleUpdateMany:g}=te(),{filename:j,isDisabled:k,couponRef:y,dataTable:D,serviceData:P,totalResults:M,resultsPerPage:I,handleChangePage:V,handleSelectFile:L,setSearchCoupon:n,handleSubmitCoupon:T,handleUploadMultiple:R,handleRemoveSelectFile:_}=Ce(h),O=()=>{n(""),y.current.value=""};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between py-4 lg:py-8 gap-4 lg:gap-2",children:[e.jsx("div",{className:"min-w-0 flex-1",children:e.jsx(ve,{children:a("CouponspageTitle")})}),e.jsxs("form",{onSubmit:T,className:"flex flex-col sm:flex-row lg:flex-row gap-2 lg:ml-4",children:[e.jsx("div",{className:"w-full sm:w-auto",children:e.jsx(Te,{title:"Coupon",exportData:h,filename:j,isDisabled:k,handleSelectFile:L,handleUploadMultiple:R,handleRemoveSelectFile:_})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs(U,{variant:"bulkAction",disabled:(t==null?void 0:t.length)<1,onClick:()=>g(t),className:"w-full sm:w-auto",children:[e.jsx("span",{children:e.jsx(ge,{})}),a("BulkAction")]}),e.jsxs(U,{variant:"delete",disabled:(t==null?void 0:t.length)<1,onClick:()=>p(t),className:"w-full sm:w-auto",children:[e.jsx("span",{children:e.jsx(je,{})}),a("Delete")]}),e.jsxs(U,{variant:"create",onClick:b,className:"w-full sm:w-auto",children:[e.jsx("span",{children:e.jsx(fe,{})}),a("AddCouponsBtn")]})]})]})]}),e.jsx(Ae,{open:r,title:s,id:x,onOpenChange:()=>u(!1),ids:(t==null?void 0:t.length)>0?t:null}),e.jsx(Me,{ids:t,title:"Coupons"}),e.jsx(we,{children:e.jsx(Re,{id:x})}),e.jsx(Ie,{children:e.jsx(oe,{className:"min-w-0 shadow-sm overflow-hidden bg-white dark:bg-gray-800 rounded-t-lg rounded-0 mb-4",children:e.jsxs(de,{className:"p-5",children:[e.jsxs("form",{onSubmit:T,className:"pb-5 flex flex-col sm:flex-row gap-3 sm:gap-4",children:[e.jsxs("div",{className:"w-full sm:flex-1 relative",children:[e.jsx(ee,{ref:y,type:"search",placeholder:a("SearchCoupon")}),e.jsx("button",{type:"submit",className:"absolute right-1 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),e.jsxs("div",{className:"flex gap-2 sm:flex-shrink-0 sm:min-w-[160px]",children:[e.jsx(U,{type:"submit",className:"h-10 flex-1 sm:min-w-[75px]",variant:"export",children:"Filter"}),e.jsx(U,{className:"h-10 flex-1 sm:min-w-[75px]",onClick:O,type:"reset",variant:"outline",children:e.jsx("span",{className:"text-black dark:text-gray-200",children:"Reset"})})]})]}),c?e.jsx(Ue,{row:12,col:8,width:140,height:20}):C?e.jsx("span",{className:"text-center mx-auto text-red-500",children:C}):(P==null?void 0:P.length)!==0?e.jsxs("div",{children:[e.jsx(pe,{className:"mb-8 rounded-b-lg",children:e.jsxs(xe,{children:[e.jsx(ue,{children:e.jsxs(se,{children:[e.jsx(v,{children:e.jsx(le,{type:"checkbox",name:"selectAll",id:"selectAll",isChecked:d,handleSelect:()=>i(h)})}),e.jsx(v,{children:a("CoupTblCampaignsName")}),e.jsx(v,{children:a("CoupTblCode")}),e.jsx(v,{children:a("Discount")}),e.jsx(v,{className:"text-center",children:a("catPublishedTbl")}),e.jsx(v,{children:a("CoupTblStartDate")}),e.jsx(v,{children:a("CoupTblEndDate")}),e.jsx(v,{children:a("CoupTblStatus")}),e.jsx(v,{className:"text-right",children:a("CoupTblActions")})]})}),e.jsx(_e,{coupons:D})]})}),e.jsx("div",{children:e.jsx(me,{resultsperpage:I,totalresults:M,onChange:V,label:"Table navigation"})})]}):e.jsx(ye,{title:"Sorry, There are no coupons right now."})]})})})]})};export{Ps as default};
